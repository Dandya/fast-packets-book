# Обзор систем захвата сетевого трафика

***

В данном разделе будут рассмотрены основные системы захвата сетевого трафика и определены те, которые являются наиболее универсальными, доступными и поддерживаемыми для применения в отечественных решениях.
Обзор системы строиться по следующему плану:

- Историческая справка;
- Доступность исходного кода;
- Лицензия распространения;
- Объем поддерживаемых устройств;
- Схема передачи сетевого трафика.

***

1. [AF_PACKET](#af_packet)
2. [AF_XDP]()
3. [Netmap]() Мало драйверов
4. [PF_RING]() Закрытый и дорогой
5. [DPDK]()
6. [Заключение]()
7. [Полезные материалы]()
8. [Источники]()

***

## AF_PACKET

При упоминании термина «захват сетевых пакетов» первое, что приходит на ум большинству — это программы «Wireshark» [1], «Tcpdump» [2] или библиотека «Libpcap». Но все эти механизмы захвата сетевого трафика основываются на подсистеме «AF_PACKET» ядра «Linux» [3].

Первая версия подсистемы появилась в версии ядра 2.0 в 1996 году, позволяя получать в пользовательском пространстве пакеты сетевого уровня с заголовком IP, что ограничивало практическое использование подсистемы. Сейчас же «AF_PACKET» предоставляет гибкий интерфейс для захвата и отправки сетевых пакетов на канальном уровне и сетевом уровне [4].

Исходный код системы доступен в репозитории ядра «Linux» по пути `linux/net/packet` и распространяется открыто под лицензией «GPL-2.0» [5]. Но применение данной системы в пользовательских программах через системные вызовы ядра «Linux» не наклакладывает на разработчиков требования лицензии «GPL-2.0», что позволяет, например, распространять библиотеку «Libpcap» под лицензией «BSD» [6].

## Полезные материалы

## Источники

1. [Описание Wireshark для систем на базе ядра Linux](https://github.com/wireshark/wireshark/blob/master/README.linux)
2. [Описание Tcpdump](https://github.com/the-tcpdump-group/tcpdump/blob/master/README.md)
3. [Исходный код захвата пакетов библиотекой Libpcap](https://github.com/the-tcpdump-group/libpcap/blob/master/pcap-linux.c)
4. [Описание системы AF_PACKET](https://man7.org/linux/man-pages/man7/packet.7.html)
5. [Исходный код системы AF_PACKET](https://github.com/torvalds/linux/tree/master/net/packet)
6. [Лицензия библиотеки Libpcap](https://github.com/the-tcpdump-group/libpcap/blob/master/LICENSE)